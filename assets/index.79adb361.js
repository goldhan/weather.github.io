var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,c=(e,t)=>{for(var s in t||(t={}))n.call(t,s)&&r(e,s,t[s]);if(a)for(var s of a(t))i.call(t,s)&&r(e,s,t[s]);return e},l=(e,a)=>t(e,s(a));import{d as o,i as m,B as d,a as p,b as h,r as u,R as g,u as y,S as v,c as f,e as w,t as E,D as N,C as x,P as b,F as I,f as T}from"./vendor.88465846.js";var S=new class{log_(e,t){console.log(`** ${e} ${o().format("HH:mm:ss")} ****`),console.log(...t)}log(...e){this.log_("log",e)}error(...e){this.log_("❌❌❌ ERROR!!!",e)}warn(...e){this.log_("⚠️⚠️⚠️ Warning",e)}success(...e){this.log_("😀 Successful!",e)}fail(...e){this.log_("🥺 Fail!",e)}tip(...e){this.log_("🤔 Tip",e)}};var $={week:{Tody:"Tody",Mon:"Monday",Tues:"Tuesday",Wed:"Wednesday",Thur:"Thursday",Fri:"Friday",Sat:"Saturday",Sun:"Sunday"},del:"Delete",inputTip:"Enter city,zip code, or airport location",noResults:"No results found",validating:"Validating city...",tooFew:"Too few characters",H:"","km/h":"km/h",tempMax:"The high will be ",tempMin:"The low will be ",cancel:"Cancel",sunrise:"Sunrise",sunset:"Sunset",POP:"Chance of Rain",humidity:"Humidity",windSpeedDay:"Wind",apparentTemp:"Feels Like",precip:"Precipitation",pressure:"Pressure",vis:"Visibility",uvIndex:"UV Index"};var k={week:{Tody:"今天",Mon:"星期一",Tues:"星期二",Wed:"星期三",Thur:"星期四",Fri:"星期五",Sat:"星期六",Sun:"星期日"},del:"删除",inputTip:"输入城市、邮政编码或机场位置",noResults:"无记录",validating:"正在验证中",tooFew:"输入太少","km/h":"公里/小时",tempMax:"最高气温",tempMin:"最低气温",H:"时",cancel:"取消",sunrise:"日出",sunset:"日落",POP:"降水概率",humidity:"湿度",windSpeedDay:"风速",apparentTemp:"体感温度",precip:"降水量",pressure:"气压",vis:"能见度",uvIndex:"紫外线指数"};m.use(d).use(p).init({resources:{en:{translation:$},zh:{translation:k}},fallbackLng:"en",debug:!1,interpolation:{escapeValue:!1}});const C={isLocalStorageEnabled(){try{return localStorage.setItem("__testItem__","_test"),localStorage.removeItem("__testItem__"),!0}catch(e){return!1}},isSessionStorageEnabled(){try{return sessionStorage.setItem("__testItem__","_test"),sessionStorage.removeItem("__testItem__"),!0}catch(e){return!1}},set(e,t,s){(t||0===t)&&(t="string"==typeof t||"number"==typeof t?t:JSON.stringify(t)),s&&this.isSessionStorageEnabled()?sessionStorage.setItem(e,t):this.isLocalStorageEnabled()&&localStorage.setItem(e,t)},get(e,t){let s;if(t&&this.isSessionStorageEnabled()){const t=sessionStorage.getItem(e);t&&(s=t.indexOf("[")>-1||t.indexOf("{")>-1?JSON.parse(t):t.trim())}else if(this.isLocalStorageEnabled()){const t=localStorage.getItem(e);t&&(s=t.indexOf("[")>-1||t.indexOf("{")>-1?JSON.parse(t):t.trim())}if(!s&&0!==s)return null;try{"object"!=typeof s&&(s=JSON.parse(s))}catch(a){}return s},remove(e,t){t&&this.isSessionStorageEnabled()?sessionStorage.removeItem(e):localStorage.removeItem(e)}};let M;const F=class{constructor(){this.getLang=()=>{let e=m.language||"en";return"zh-CN"===e&&(e="zh"),e},this.isNeedUpdateCityInfoCache=()=>{const e=C.get("citys");if(e){const{data:t}=e,[s]=t;return!!s&&s.lang!==this.getLang()}return!1}}};let _=F;_.Instance=()=>M||(M=new F,M);var O=_.Instance();let D;console.log({}.APIKEY);const P=class{constructor(){this.getWithApi=(e,t,s=!1)=>{let a="https://devapi.qweather.com/v7/weather";s&&(a="https://geoapi.qweather.com/v2");let n="?key=eb3f2048fd264f6cbc6f49be9d472b9d";if(t)for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){n+=`&${r}=${t[r]}`}const i=`&lang=${O.getLang()}`;return this.get(`${a}${e}${n}${i}`)},this.searchCity=e=>this.getWithApi("/city/lookup",{location:e},!0),this.get=e=>(S.log("↑",e),h.get(e,{timeout:6e4}).then((t=>(S.log("↓",e,"\n",t.data),t.data))).catch((e=>{e&&S.error("net err",e)})))}};let R=P;R.Instance=()=>D||(D=new P,D);var W=R.Instance(),L="/weather.github.io/assets/cloudy.644870ff.jpg",j="/weather.github.io/assets/heavy_rain.686c2e40.jpg",z="/weather.github.io/assets/snow.c4aaf8ed.jpg";let H;const U=class{constructor(){this.getTempUnit=()=>{if(this.unit)return this.unit;const e=C.get("tempUnit");return e?(this.unit=e,e):(this.setTempUnit("C"),"C")},this.setTempUnit=e=>{C.set("tempUnit",e),this.unit=e},this.getDataWithCitys=(e,t=!1)=>{const s=e.map((e=>this.getDataWithCity(e,t)));return Promise.all(s)},this.getDataWithCity=(e,t=!1)=>{const s=e.cityId,a=this.temp[s];let n=!1;return a&&(new Date).getTime()-a.updateTime>6e4&&!t&&(n=!0),!a||n?this.getDataWithNet(e).then((e=>(this.temp[s]=e,e))):new Promise((e=>e(a)))},this.getBg=e=>{let t="";switch(parseInt(e,10)){case 150:case 153:case 100:t="/weather.github.io/assets/sunny.97297840.jpg";break;case 101:case 103:case 102:t=L;break;case 104:case 154:t="/weather.github.io/assets/overcast.9d19d64c.jpg";break;case 300:case 301:case 302:case 303:case 304:t="/weather.github.io/assets/thunder.b1809533.jpg";break;case 305:case 309:t="/weather.github.io/assets/light_rain.bcb223e1.jpg";break;case 306:case 313:t=j;break;case 307:case 308:case 310:case 311:case 312:case 350:t=j;break;case 400:t=z;break;case 401:case 407:t=z;break;case 402:case 403:t=z;break;case 404:case 405:case 406:t=z;break;default:t=""}return t},this.T=e=>m.t(e),this.getDataWithNet=e=>{const t=e=>{const t=o(e).format("d");return`${this.T(`week.${["Sun","Mon","Tues","Wed","Thur","Fri","Sat"][parseInt(t,10)]}`)}`},s=e=>`${(32+1.8*parseFloat(e)).toFixed(0)}`,a=[[this.T("sunrise"),"sunrise"],[this.T("sunset"),"sunset"],[this.T("POP"),""],[this.T("humidity"),"humidity"],[this.T("windSpeedDay"),"windSpeedDay"],[this.T("apparentTemp"),""],[this.T("precip"),"precip"],[this.T("pressure"),"pressure"],[this.T("vis"),"vis"],[this.T("uvIndex"),"uvIndex"]],n=e.cityId,i=W.getWithApi("/now",{location:n}),r=W.getWithApi("/24h",{location:n}),m=W.getWithApi("/10d",{location:n});return Promise.all([i,r,m]).then((([n,i,r])=>{const o=l(c({},e),{updateTime:(new Date).getTime(),desc:"--",descF:"--",base:{tempF:"--",text:"--",temp:"--",icon:"--",windDir:"--",windSpeed:"--",windScale:"--",tempMax:"--",tempMin:"--",tempMaxF:"--",tempMinF:"--",week:"--",hour:"--",iconDay:"--",bg:""},detail:[],days:[],hours:[]});if(n&&"200"===n.code&&(o.base=n.now,o.base.tempF=s(o.base.temp)),i&&"200"===i.code&&(o.hours=i.hourly.map((e=>l(c({},e),{hour:e.fxTime.split("T")[1].split(":")[0],tempF:s(e.temp)})))),r&&"200"===r.code&&(o.days=r.daily.map((e=>l(c({},e),{week:t(e.fxDate),tempMinF:s(e.tempMin),tempMaxF:s(e.tempMax)})))),o.days.length){const[e]=o.days,{tempMax:t,tempMin:s,tempMinF:a,tempMaxF:n}=e;o.base.tempMin=s,o.base.tempMax=t,o.base.tempMinF=a,o.base.tempMaxF=n}const m=r.daily[0];o.detail=a.map(((e,t)=>{let s=m[e[1]];return"windSpeedDay"===e[1]&&(s=o.base.windSpeed),{name:e[0],value:s}}));const d=o.base;return o.base.bg=this.getBg(o.base.icon),o.desc=`${this.T("week.Tody")}：${d.text}，${d.windDir}${d.windSpeed}${this.T("km/h")}。${this.T("tempMax")}${d.tempMax||"--"}°，${this.T("tempMin")}${d.tempMin||"--"}°`,o.descF=`${this.T("week.Tody")}：${d.text}，${d.windDir}${d.windSpeed}${this.T("km/h")}。${this.T("tempMax")}${d.tempMaxF||"--"}°，${this.T("tempMin")}${d.tempMinF||"--"}°`,o}))},this.temp={},this.unit=this.getTempUnit()}};let A=U;A.Instance=()=>H||(H=new U,H);var B=A.Instance();const V="https://raw.githubusercontent.com/qwd/WeatherIcon/master/weather-icon-S2/64",q=e=>{const{city:t,unit:s,onLoaded:a,refInstance:n}=e,i=t.index,r=u.exports.useRef(!1),{t:o}=y(),[m,d]=u.exports.useState(l(c({updateTime:0},t),{desc:"--",descF:"--",base:{tempF:"--",text:"--",temp:"--",icon:"--",windDir:"--",windSpeed:"--",windScale:"--",tempMax:"--",tempMin:"--",tempMaxF:"--",tempMinF:"--",week:"--",hour:"--",iconDay:"--",bg:""},detail:[],days:[],hours:[]})),p=u.exports.useRef({}),h=u.exports.useRef(0),v=u.exports.useRef(window.innerHeight);u.exports.useImperativeHandle(n,(()=>({refresh:f})));const f=u.exports.useCallback((()=>{w(t)}),[t]);u.exports.useEffect((()=>{window.onresize=()=>{v.current!==window.innerHeight&&v.current<=750&&window.location.reload(),v.current=window.innerHeight}}),[t]),u.exports.useEffect((()=>{p.current={}}),[m]);const w=e=>{B.getDataWithCity(e).then((e=>{d(e),a&&a(e)}))},E=e=>{let t=p.current[e];return t||(t=document.getElementsByClassName(`${e} index-${i}`)[0],p.current[e]=t,t)},N=u.exports.useRef({}),x=e=>{let t=N.current[e];if(t)return t;const s=E(e);return N.current[e]=s.clientHeight,s.clientHeight},b=u.exports.useRef(0),{base:I,detail:T,days:S,hours:$}=m,k=S&&S[0]?S[0]:I,C="F"===s;let M=`${t.adm2||""}${t.cityName||"--"}`;return t.cityName===t.adm2&&(M=t.cityName||"--"),g.createElement("div",{className:`detail-container index-${i}`},g.createElement("div",{className:`container-head index-${i}`},g.createElement("p",{className:"head-location"},M),g.createElement("p",{className:"head-status"},I.text||"--"),g.createElement("p",{className:`head-temperature index-${i}`},C?I.tempF||"--":I.temp||"--","°")),g.createElement("div",{className:`container-scroll index-${i}`,onScroll:e=>{if(e.target){const t=e.target,s=E("head-temperature"),a=E("container-head"),n=E("detail-tody"),i=E("detail-scroll-wrapped"),c=x("head-temperature"),l=x("detail-head"),o=x("detail-tody"),m=x("detail-container"),d=b.current-t.scrollTop<0;b.current=t.scrollTop;const p=30,h=c,u=1-t.scrollTop/h;u<0?(s.style.opacity="0",n.style.opacity="0",a.style.marginTop="0"):(s.style.opacity=`${u}`,n.style.opacity=`${u}`,a.style.marginTop=10*u+"px"),t.scrollTop<h&&r.current&&(r.current=!1,i.style.overflow="hidden"),d&&t.scrollTop>=h&&!r.current&&(r.current=!0,t.scrollTo(0,h),i.style.height=m-l-o-p+"px",i.style.overflow="auto")}}},g.createElement("div",{className:"float-detail"},g.createElement("div",{className:`detail-tody index-${i}`},g.createElement("div",{className:"detail-tody-wrapped"},g.createElement("div",{className:"tody-time"},`${k.week} ${o("week.Tody")}`),g.createElement("div",{className:"tody-temp"},C?k.tempMaxF:k.tempMax,g.createElement("span",null,C?k.tempMinF:k.tempMin)))),g.createElement("div",{className:`detail-head index-${i}`},g.createElement("div",{className:"content"},$.map(((e,t)=>{const s=`detail-head-key-index-${t}`;return g.createElement("div",{key:s,className:"hour"},g.createElement("div",null,e.hour,o("H")),g.createElement("div",null,g.createElement("img",{src:`${V}/${e.icon}.png`,alt:"icon"})),g.createElement("div",null,C?e.tempF:e.temp,"°"))}))))),g.createElement("div",{className:`detail-scroll-wrapped index-${i}`,onScroll:e=>{if(e.target){const t=e.target,s=E("container-scroll"),a=h.current-t.scrollTop<0;h.current=t.scrollTop,t.scrollTop<=0&&(s.style.overflow="auto"),a&&t.scrollTop&&(s.style.overflow="hidden")}}},g.createElement("div",{className:"detail-scroll"},g.createElement("div",{className:"detail-space"}),g.createElement("div",{className:"detail-content"},g.createElement("div",{className:"day"},S.map(((e,t)=>{const s=`day-key-index-${t}`;return 0===t?null:g.createElement("div",{key:s,className:"day-item"},g.createElement("div",{className:"item-wrapped"},g.createElement("div",{className:"time"},e.week),g.createElement("div",{className:"icon"},g.createElement("img",{src:`${V}/${e.iconDay}.png`,alt:"icon"})),g.createElement("div",{className:"temp"},C?e.tempMaxF:e.tempMax,g.createElement("span",null,C?e.tempMinF:e.tempMin))))}))),g.createElement("div",{className:"desc"},C?m.descF:m.desc),g.createElement("div",{className:"other"},T.map(((e,t)=>{const s=`info-key-index-${t}`;return g.createElement("div",{key:s,className:"info-item"},g.createElement("div",{className:"item-wrapped"},g.createElement("span",null,e.name,":"),g.createElement("span",null,e.value)),t%2!=0?g.createElement("div",{className:"space"}):null)}))))))))};var J=u.exports.forwardRef(((e,t)=>g.createElement(q,l(c({},e),{refInstance:t}))));let Z;const K=class{constructor(){this.addCity=e=>{const t=this.citys.filter((t=>t.cityId!==e.cityId));this.citys=[...t,l(c({},e),{index:t.length})],C.set("citys",{data:this.citys})},this.delCity=e=>{this.citys=this.citys.filter((t=>t.cityId!==e.cityId)),C.set("citys",{data:this.citys})},this.updateNearCity=()=>this.getLocation().then((e=>this.getCityWithLocation(e).then((e=>!!e&&(0===this.citys.length?this.citys=[e]:this.citys[0].isNear?this.citys[0]=e:this.citys=[e,...this.citys],C.set("citys",{data:this.citys}),!0))).catch((e=>!1)))).catch((e=>!1)),this.getCitys=()=>new Promise(((e,t)=>{if(this.citys.length)e(this.citys);else{const s=C.get("citys");if(s){const{data:t}=s;this.citys=t,this.updateNearCity().then((t=>{O.isNeedUpdateCityInfoCache()?this.updateCitys(this.citys).then((t=>{this.citys=this.citys.map((e=>{const s=t[e.cityId];return c(c({},e),s)})),C.set("citys",{data:this.citys}),e(this.citys)})):e(this.citys)}))}else this.getLocation().then((s=>{this.getCityWithLocation(s).then((t=>{if(t){const s=[t];C.set("citys",{data:s}),this.citys=s,e(s)}})).catch(t)})).catch(t)}})),this.updateCitysStorage=e=>{this.citys=e.map(((e,t)=>l(c({},e),{index:t}))),C.set("citys",{data:this.citys})},this.updateCitys=e=>{const t=O.getLang(),s=e.filter((e=>e.lang!==t)).map((e=>W.searchCity(e.cityId)));return Promise.all(s).then((s=>{const a={};return s.forEach(((s,n)=>{if("200"===s.code&&s.location&&s.location.length){const[i]=s.location,{name:r,id:c,tz:l,utcOffset:o,adm1:m,adm2:d,country:p}=i;a[c]={cityName:r,cityId:c,isNear:e[n].isNear,index:n,tz:l,utcOffset:o,adm1:m,adm2:d,country:p,lang:t}}else S.error(s.code)})),a}))},this.getLocation=()=>new Promise(((e,t)=>{const s=C.get("Location");s?e(s):navigator.geolocation?navigator.geolocation.getCurrentPosition((t=>{const{latitude:s,longitude:a}=t.coords,n={latitude:`${s}`,longitude:`${a}`};C.set("Location",n),e(n)}),(e=>{t(e)})):t("不支持定位")})),this.getCityWithLocation=e=>{const{latitude:t,longitude:s}=e;return W.getWithApi("/city/lookup",{location:`${s},${t}`},!0).then((e=>{if("200"===e.code&&e.location&&e.location.length){const{name:t,id:s,tz:a,utcOffset:n,adm1:i,adm2:r,country:c}=e.location[0];return{cityName:t,cityId:s,isNear:!0,index:0,tz:a,utcOffset:n,adm1:i,adm2:r,country:c,lang:O.getLang()}}return null}))},this.citys=[]}};let X=K;X.Instance=()=>Z||(Z=new K,Z);var Y=X.Instance(),G="/weather.github.io/assets/near_me_white_24dp.b4a7d7e6.svg";const Q=e=>{const{goto:t,className:s,refInstance:a}=e,[n,i]=u.exports.useState([]),[r,l]=u.exports.useState(0),[o,m]=u.exports.useState(null),[d,p]=u.exports.useState(!1),[h,y]=u.exports.useState(B.getTempUnit()),[w,E]=u.exports.useState({}),N=u.exports.useRef({});u.exports.useEffect((()=>{b(r)}),[n]);const x=()=>{Y.getCitys().then((e=>{i(e)})).catch((e=>{p(!0),oe.Instance().push("search-view")})),y(B.getTempUnit())},b=e=>{if(n.length){const t=N.current[n[e].cityId];t&&t.refresh()}},I=e=>{o&&o.slideTo(e)};return u.exports.useImperativeHandle(a,(()=>({refresh:x,slideTo:I}))),g.createElement("div",{className:`main-container ${s||""}`},n.length?g.createElement(g.Fragment,null,g.createElement("div",{className:"main-background"},g.createElement("img",{src:w[n[r].cityId],alt:""})),g.createElement("div",{className:"main"},g.createElement(v,{className:"swiper",cssMode:!0,onSwiper:e=>{e&&m(e)},onSlideChange:e=>{l(e.activeIndex),b(e.activeIndex)}},n.map(((e,t)=>{const s=`detail-key-${t}`;return g.createElement(f,{key:s},g.createElement(J,{ref:t=>{N.current[e.cityId]=t},city:e,unit:h,onLoaded:e=>{E((t=>{const s=c({},t);return s[e.cityId]=e.base.bg,s[e.cityId]||console.log(e.base.icon,"没有背景"),s}))}}))})))),g.createElement("div",{className:"bottom"},g.createElement("div",null,g.createElement("div",{className:"support",onClick:()=>window.open("https://dev.qweather.com/")},g.createElement("img",{alt:"hefeng",src:"https://www.qweather.com/favicon-32x32.png?v=2021010553"})),g.createElement("div",{className:"page"},g.createElement("div",{onClick:()=>{o&&o.slidePrev()}}),g.createElement("div",{className:"points"},n.map(((e,t)=>{const s=`point-key-${t}`;return g.createElement("div",{key:s,onClick:()=>{I(t)}},e.isNear?g.createElement("img",{className:r===t?"point selected":"point",alt:"near",src:G}):g.createElement("div",{className:r===t?"point selected":"point"}))}))),g.createElement("div",{onClick:()=>{o&&o.slideNext()}})),g.createElement("div",{className:"menu",onClick:()=>{oe.Instance().push("list-view")}},g.createElement("img",{alt:"list",src:"/weather.github.io/assets/list_white_24dp.90359f7c.svg"}))))):g.createElement("div",{className:"status"},d?g.createElement("div",{onClick:()=>{oe.Instance().push("search-view")}},d?"获取定位失败，点击搜索城市":""):"Loading......"))};var ee=u.exports.forwardRef(((e,t)=>g.createElement(Q,l(c({},e),{refInstance:t}))));o.extend(w),o.extend(E);const te=e=>{const{className:t,delHandle:s,refInstance:a,onClick:n}=e,[i,r]=u.exports.useState([]),[m,d]=u.exports.useState({}),[p,h]=u.exports.useState(B.getTempUnit()),[v,f]=u.exports.useState(!1),[w,E]=u.exports.useState(""),{t:I}=y(),T=u.exports.useRef();u.exports.useEffect((()=>{}),[]),ce(((e,t,s,a)=>{"list-view"===s&&(f(!1),S(),C()),"list-view"===t&&k()}),"list-view"),u.exports.useEffect((()=>(i.length&&($(i),C()),()=>{k()})),[i]);const S=()=>{Y.getCitys().then((e=>{B.getDataWithCitys(e,!0).then((e=>{r(e);const t=Math.floor(Math.random()*e.length);E(e[t].base.bg)}))})),h(B.getTempUnit())},$=e=>{const t={};e.forEach(((e,s)=>{t[e.tz]||(t[e.tz]=o().tz(e.tz).format("HH:mm"))})),d(t)},k=()=>{T.current&&(clearInterval(T.current),console.log("stop timer",T.current),T.current=void 0)},C=()=>{k(),T.current=setInterval((()=>{$(i)}),3e3),console.log("start timer",T.current)},M=()=>{const e=document.getElementsByClassName("item-scroll");for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){e[t].scrollTo(0,0)}},F=e=>g.createElement("div",null,g.createElement("div",{className:"item-del",onClick:t=>{Y.delCity(e),S(),s&&s(e),M()}},g.createElement("p",null,I("del"))),g.createElement("div",{className:`item-scroll ${e.index}`,style:{overflowX:e.isNear?"hidden":"scroll"}},g.createElement("div",{className:"item-wrapped"},g.createElement("div",{className:"item-left",onClick:()=>{v&&Y.updateCitysStorage(i),n&&n(e),M(),oe.Instance().pop(null,"list-view")}},g.createElement("img",{className:"item-bg",src:e.base.bg,alt:""}),g.createElement("div",{className:"item-content-wrapped"},g.createElement("div",{className:"item-content"},g.createElement("div",null,g.createElement("span",{className:"time"},m[e.tz]||"--",e.isNear?g.createElement("img",{className:"near",src:G,alt:"near"}):null),g.createElement("span",{className:"city-name"},e.cityName,g.createElement("span",null,`${e.adm2===e.cityName?e.adm1:e.adm2}`))),g.createElement("div",null,g.createElement("div",{className:"temp"},P?e.base.tempF:e.base.temp,"°"))))),g.createElement("div",{className:"item-right"}))));u.exports.useImperativeHandle(a,(()=>({refresh:S})));const _=i.filter((e=>e.isNear)),O=_.length?_[0]:void 0,D=i.filter((e=>!e.isNear)),P="F"===p;return g.createElement("div",{className:`list-container ${t||""}`},g.createElement("div",{className:"bg"},g.createElement("img",{alt:"bg",src:w})),g.createElement("div",{className:"content"},O?g.createElement("div",{className:"item"},F(O)):null,g.createElement(N,{onDragEnd:e=>{if(!e.destination)return;let t=((e,t,s)=>{const a=Array.from(e),[n]=a.splice(t,1);return a.splice(s,0,n),a})(i.filter((e=>!e.isNear)),e.source.index,e.destination.index);v||f(!0),t=[...i.filter((e=>e.isNear)),...t].map(((e,t)=>l(c({},e),{index:t}))),r(t)}},g.createElement(x,{droppableId:"droppable"},((e,t)=>g.createElement("div",l(c({},e.droppableProps),{ref:e.innerRef}),D.map(((e,t)=>{const s=`city-key-${t}`;return g.createElement(b,{key:s,draggableId:s,index:t,isDragDisabled:e.isNear,disableInteractiveElementBlocking:e.isNear},((t,s)=>g.createElement("div",l(c(c({className:"item",ref:t.innerRef},t.draggableProps),t.dragHandleProps),{style:c({userSelect:"none"},t.draggableProps.style)}),F(e))))})),e.placeholder)))),g.createElement("div",{className:"set"},g.createElement("div",{className:"temp-unit",onClick:()=>{const e="C"===p?"F":"C";B.setTempUnit(e),h(e)}},g.createElement("span",{className:P?"":"active"},"℃"),"/",g.createElement("span",{className:P?"active":""},"℉")),g.createElement("div",{onClick:()=>{oe.Instance().push("search-view","list-view")}},g.createElement("img",{alt:"add",src:"/weather.github.io/assets/add_circle_outline_white_24dp.76c90b06.svg"}))),g.createElement("div",{className:"support"},g.createElement("img",{onClick:()=>window.open("https://dev.qweather.com/"),alt:"hefeng",src:"https://www.qweather.com/favicon-32x32.png?v=2021010553"}))))};var se=u.exports.forwardRef(((e,t)=>g.createElement(te,l(c({},e),{refInstance:t}))));const ae={encodeString:(e,t=15,s="...")=>e.length<t&&e.length>5?`${e.slice(0,2)}${s}`:e.length>15?`${e.slice(0,5)}${s}${e.slice(e.length-5,e.length)}`:s,getDomainStr(e){if(e){const t=e.match("^((http://)|(https://))?([a-zA-Z0-9]([a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,6}(/)");if(null==t?void 0:t.length){let e=t[0];return e=e.replace("http://",""),e=e.replace("https://",""),e=e.replace("wss://",""),e}if(e.length){let t=e;return t=t.replace("http://",""),t=t.replace("https://",""),t=t.replace("wss://",""),t}return e}return""},getIcoWithDomain(e){return e?`https://www.google.com/s2/favicons?domain=${this.getDomainStr(e)}`:""},isObject(e){const t=typeof e;return null!=e&&("object"===t||"function"===t)},debounce(e,t,s){let a,n,i,r,c,l,o=0,m=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){const s=a,i=n;return a=void 0,n=void 0,o=t,r=e.apply(i,s),r}function u(e,t){return setTimeout(e,t)}function g(e){return c=void 0,p&&a?h(e):(a=void 0,n=void 0,r)}function y(e){const s=e-l;return void 0===l||s>=t||s<0||d&&e-o>=i}function v(){const e=Date.now();y(e)?g(e):c=u(v,function(e){const s=e-o,a=t-(e-l);return d?Math.min(a,i-s):a}(e))}t=+t||0,this.isObject(s)&&(m=!!s.leading,d="maxWait"in s,i=d?Math.max(+s.maxWait||0,t):i,p="trailing"in s?!!s.trailing:p);const f=(...e)=>{const s=Date.now(),i=y(s);if(a=e,n=this,l=s,i){if(void 0===c)return function(e){return o=e,c=u(v,t),m?h(e):r}(l);if(d)return c=u(v,t),h(l)}return void 0===c&&(c=u(v,t)),r};return f.cancel=function(){void 0!==c&&clearTimeout(c),o=0,a=void 0,l=void 0,n=void 0,c=void 0},f.flush=function(){return void 0===c?r:g(Date.now())},f.pending=function(){return void 0!==c},f},throttle(e,t,s){let a=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return this.isObject(s)&&(a="leading"in s?!!s.leading:a,n="trailing"in s?!!s.trailing:n),this.debounce(e,t,{leading:a,trailing:n,maxWait:t})}};const ne=e=>{const{className:t,goto:s,refInstance:a,onClick:n}=e,[i,r]=u.exports.useState([]),[c,l]=u.exports.useState(""),[o,m]=u.exports.useState(!1),{t:d}=y(),p=u.exports.useRef(ae.debounce((e=>{const t=O.getLang();W.searchCity(e).then((e=>{if("200"===e.code&&e.location&&e.location.length){const s=e.location.map(((e,s)=>{const{name:a,id:n,tz:i,utcOffset:r,adm1:c,adm2:l,country:o}=e;return{cityName:a,cityId:n,isNear:!1,index:s,tz:i,utcOffset:r,adm1:c,adm2:l,country:o,lang:t}}));r(s)}else r([])})).finally((()=>m(!1)))}),500,{}));u.exports.useEffect((()=>{}),[]);const h=(e,t)=>{let s=e.toUpperCase();const a=t.toUpperCase().replace(s,"@");let n=a.split("@");if(n.length<=1&&(s=e.toLowerCase(),n=a.split("@")),n.length>1){const[e,t]=n;return`${e||""}<span class="red">${s}</span>${t||""}`}return t};let v="";return 1===c.length&&(v=d("tooFew")),c.length>=2&&0===i.length&&!o&&(v=d("noResults")),o&&(v=d("validating")),g.createElement("div",{className:`search-container ${t||""}`},g.createElement("div",{className:"content"},g.createElement("div",{className:"head"},g.createElement("span",null,d("inputTip")),g.createElement("div",null,g.createElement("div",{className:"input"},g.createElement("img",{alt:"search",src:"/weather.github.io/assets/search_white_24dp.d63f5ef7.svg"}),g.createElement("input",{type:"text",onChange:e=>{let{value:t}=e.target;t=t.trim(),l(t),t.length>1?(m(!0),p.current(t)):r([])},value:c})),g.createElement("div",{onClick:()=>{oe.Instance().pop(null,"search-view")}},d("cancel")))),g.createElement("div",{className:"result"},g.createElement("div",{className:"result-item"},g.createElement("p",null,v)),i.map(((e,t)=>{const s=`r-${t}`,{adm1:a,adm2:i,country:o,cityName:m}=e;return g.createElement("div",{className:"result-item",key:s,onClick:()=>{Y.addCity(e),n&&n(e),r([]),l(""),oe.Instance().pop(null,"search-view")}},g.createElement("p",{dangerouslySetInnerHTML:{__html:h(c,m)}}),g.createElement("span",{dangerouslySetInnerHTML:{__html:h(c,`${o} ${a} ${i}`)}}))})))))};var ie=u.exports.forwardRef(((e,t)=>g.createElement(ne,l(c({},e),{refInstance:t}))));let re;const ce=(e,t)=>{oe.Instance().cycle(t,e)},le=class{constructor(){this.setRootView=e=>{this.views=e?[e]:[this.getRootView()]},this.cycle=(e,t)=>{this.cycleFuncs[e]=t},this.push=(e,t,s)=>{0==this.views.length&&this.setRootView();const a=document.getElementsByClassName(e)[0];t&&this.views[this.views.length-1]!==t&&this.views.push(t),t=t||this.views[this.views.length-1];const n=document.getElementsByClassName(t)[0];a.style.top="0",a.style.zIndex="1",n.style.zIndex="0",this.views.push(e);for(const i in this.cycleFuncs)if(Object.prototype.hasOwnProperty.call(this.cycleFuncs,i)){(0,this.cycleFuncs[i])("push",t,e,s)}},this.pop=(e,t)=>{if(0===this.views.length&&this.setRootView(),t&&this.views[this.views.length-1]!==t&&this.views.push(t),1===this.views.length)return;t=t||this.views[this.views.length-1];const s=document.getElementsByClassName(t)[0];s.style.top="100%",s.style.zIndex="0",this.views.pop();for(const a in this.cycleFuncs)if(Object.prototype.hasOwnProperty.call(this.cycleFuncs,a)){(0,this.cycleFuncs[a])("pop",t,this.views[this.views.length-1],e)}},this.getRootView=()=>document.getElementsByClassName("nav")[0].children[0].className,this.createNavigatorController=e=>(this.setRootView(e[0].props.className||""),g.createElement("div",{className:"container nav"},e)),this.views=[],this.cycleFuncs={}}};let oe=le;oe.Instance=()=>re||(re=new le,re);const me=()=>{const e=u.exports.useRef(null),t=u.exports.useRef(null);return u.exports.useEffect((()=>{e.current&&e.current.refresh()}),[]),oe.Instance().createNavigatorController([g.createElement("div",{className:"main-view",key:"main-view"},g.createElement(ee,{ref:e})),g.createElement("div",{className:"list-view",key:"list-view"},g.createElement(se,{ref:t,onClick:t=>{e.current&&(e.current.refresh(),e.current.slideTo(t.index))},delHandle:t=>{e.current&&e.current.refresh()}})),g.createElement("div",{className:"search-view",key:"search-view"},g.createElement(ie,{onClick:s=>{t.current&&t.current.refresh(),e.current&&e.current.refresh()}}))])};function de(){return u.exports.useEffect((()=>{I(document.body)}),[]),g.createElement("div",{className:"App"},g.createElement(me,null))}T.render(g.createElement(g.StrictMode,null,g.createElement(de,null)),document.getElementById("root"));
